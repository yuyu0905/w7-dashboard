import{S as u}from"./sweetalert2.all-5934950a.js";import{M as k,P as V,D as C}from"./DelModal-6c93af69.js";import{_ as y,o as i,c as a,b as e,d as n,v as c,F as v,j as U,k as x,r as p,a as _,t as f}from"./index-78da3a39.js";const{VITE_API:T,VITE_APIPATH:L}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"vue-hexschool-product-list",BASE_URL:"/w7-dashboard/",MODE:"production",DEV:!1,PROD:!0},A={props:["tempProduct","operateType"],emits:["saveProduct"],data(){return{productModal:""}},methods:{createImagesUrl(){this.innerProduct.imagesUrl||(this.innerProduct.imagesUrl=[]),this.innerProduct.imagesUrl.push("")},deleteImagesUrl(){this.innerProduct.imagesUrl.pop()},showModal(){this.productModal.show()},hideModal(){this.productModal.hide()},uploadFile(){const l=new FormData;l.append("file-to-upload",this.$refs.fileInput.files[0]);const t=`${T}/api/${L}/admin/upload`;u.fire({title:"上傳圖片中",timer:2e3,timerProgressBar:!0,didOpen:()=>{u.showLoading()},willClose:()=>{this.$http.post(t,l,{headers:{"Content-Type":"multipart/form-data"}}).then(r=>{r.data.success&&(this.innerProduct.imageUrl=r.data.imageUrl),this.$refs.fileInput.value=""}).catch(r=>{u.fire({icon:"error",title:r.response.data.message}),this.$refs.fileInput.value=""})}})}},mounted(){this.productModal=new k(this.$refs.productModal,{keyboard:!1})},computed:{innerProduct(){return this.tempProduct}}},E={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},D={class:"modal-dialog modal-xl"},B={class:"modal-content border-0"},F={class:"modal-header bg-dark text-white"},$={id:"productModalLabel",class:"modal-title"},S={key:0},H={key:1},N=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),O={class:"modal-body"},R={class:"row"},j={class:"col-sm-4"},q={class:"mb-2"},z={class:"mb-3"},G=e("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),J={class:"mb-3"},K=e("label",{for:"uploadFile",class:"form-label"},"或 上傳圖片",-1),Q=["src"],W=e("h3",{class:"mb-3"},"多圖新增",-1),X=e("label",{for:"imagesUrl",class:"form-label"},"圖片網址",-1),Y=["onUpdate:modelValue"],Z=["src"],ee={key:0},te={key:1},oe={class:"col-sm-8"},se={class:"mb-3"},le=e("label",{for:"title",class:"form-label"},"標題",-1),ie={class:"row"},ae={class:"mb-3 col-md-6"},re=e("label",{for:"category",class:"form-label"},"分類",-1),ne={class:"mb-3 col-md-6"},de=e("label",{for:"price",class:"form-label"},"單位",-1),ce={class:"row"},ue={class:"mb-3 col-md-6"},me=e("label",{for:"origin_price",class:"form-label"},"原價",-1),he={class:"mb-3 col-md-6"},pe=e("label",{for:"price",class:"form-label"},"售價",-1),_e=e("hr",null,null,-1),fe={class:"mb-3"},be=e("label",{for:"description",class:"form-label"},"產品描述",-1),ge={class:"mb-3"},Pe=e("label",{for:"content",class:"form-label"},"說明內容",-1),ve={class:"mb-3"},ye={class:"form-check"},Ue=e("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Me={class:"modal-footer"},Ie=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function we(l,t,r,M,m,o){return i(),a("div",E,[e("div",D,[e("div",B,[e("div",F,[e("h5",$,[r.operateType==="create"?(i(),a("span",S,"新增產品")):(i(),a("span",H,"編輯產品"))]),N]),e("div",O,[e("div",R,[e("div",j,[e("div",q,[e("div",z,[G,n(e("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結",id:"imageUrl","onUpdate:modelValue":t[0]||(t[0]=s=>o.innerProduct.imageUrl=s)},null,512),[[c,o.innerProduct.imageUrl]])]),e("div",J,[K,e("input",{type:"file",id:"uploadFile",class:"form-control",ref:"fileInput",onChange:t[1]||(t[1]=(...s)=>o.uploadFile&&o.uploadFile(...s))},null,544)]),e("img",{class:"img-fluid",src:o.innerProduct.imageUrl},null,8,Q)]),W,(i(!0),a(v,null,U(o.innerProduct.imagesUrl,(s,h)=>(i(),a("div",{class:"mb-3",key:h},[X,n(e("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結",id:"imagesUrl","onUpdate:modelValue":P=>o.innerProduct.imagesUrl[h]=P},null,8,Y),[[c,o.innerProduct.imagesUrl[h]]]),e("img",{class:"img-fluid",src:o.innerProduct.imagesUrl[h]},null,8,Z)]))),128)),!o.innerProduct.imagesUrl||!o.innerProduct.imagesUrl.length||o.innerProduct.imagesUrl[o.innerProduct.imagesUrl.length-1]?(i(),a("div",ee,[e("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:t[2]||(t[2]=(...s)=>o.createImagesUrl&&o.createImagesUrl(...s))}," 新增圖片 ")])):(i(),a("div",te,[e("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:t[3]||(t[3]=(...s)=>o.deleteImagesUrl&&o.deleteImagesUrl(...s))}," 刪除圖片 ")]))]),e("div",oe,[e("div",se,[le,n(e("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":t[4]||(t[4]=s=>o.innerProduct.title=s)},null,512),[[c,o.innerProduct.title]])]),e("div",ie,[e("div",ae,[re,n(e("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":t[5]||(t[5]=s=>o.innerProduct.category=s)},null,512),[[c,o.innerProduct.category]])]),e("div",ne,[de,n(e("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":t[6]||(t[6]=s=>o.innerProduct.unit=s)},null,512),[[c,o.innerProduct.unit]])])]),e("div",ce,[e("div",ue,[me,n(e("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":t[7]||(t[7]=s=>o.innerProduct.origin_price=s)},null,512),[[c,o.innerProduct.origin_price,void 0,{number:!0}]])]),e("div",he,[pe,n(e("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":t[8]||(t[8]=s=>o.innerProduct.price=s)},null,512),[[c,o.innerProduct.price,void 0,{number:!0}]])])]),_e,e("div",fe,[be,n(e("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":t[9]||(t[9]=s=>o.innerProduct.description=s)},`\r
                    `,512),[[c,o.innerProduct.description]])]),e("div",ge,[Pe,n(e("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":t[10]||(t[10]=s=>o.innerProduct.content=s)},`\r
                    `,512),[[c,o.innerProduct.content]])]),e("div",ve,[e("div",ye,[n(e("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[11]||(t[11]=s=>o.innerProduct.is_enabled=s)},null,512),[[x,o.innerProduct.is_enabled]]),Ue])])])])]),e("div",Me,[Ie,e("button",{type:"button",class:"btn btn-primary",onClick:t[12]||(t[12]=s=>l.$emit("saveProduct",o.innerProduct))}," 確認 ")])])])],512)}const ke=y(A,[["render",we]]),{VITE_API:b,VITE_APIPATH:g}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"vue-hexschool-product-list",BASE_URL:"/w7-dashboard/",MODE:"production",DEV:!1,PROD:!0},Ve={data(){return{isLoading:!1,products:[],operateType:"",tempProduct:{imagesUrl:[]},pagination:{},pageNum:1}},methods:{getProducts(l=1){this.isLoading=!0,this.pageNum=l,this.$http.get(`${b}/api/${g}/admin/products?page=${l}`).then(t=>{this.products=t.data.products,this.pagination=t.data.pagination,this.isLoading=!1}).catch(t=>{u.fire({icon:"error",title:t.response.data.message,showConfirmButton:!1,timer:1500}),this.isLoading=!1})},saveProduct(l){this.isLoading=!0;let t=`${b}/api/${g}/admin/product`;this.operateType==="modify"&&(t=`${b}/api/${g}/admin/product/${l.id}`),this.$http[this.operateType==="create"?"post":"put"](`${t}`,{data:l}).then(r=>{this.$refs.productModal.hideModal(),u.fire({icon:"success",title:r.data.message,showConfirmButton:!1,timer:1500}),this.getProducts(this.pageNum),this.isLoading=!1}).catch(r=>{u.fire({icon:"error",title:r.response.data.message,showConfirmButton:!1,timer:1500}),this.isLoading=!1})},deleteProduct(){this.isLoading=!0,this.$http.delete(`${b}/api/${g}/admin/product/${this.tempProduct.id}`,{data:this.tempProduct}).then(l=>{this.$refs.delModal.hideModal(),u.fire({icon:"success",title:l.data.message,showConfirmButton:!1,timer:1500}),this.getProducts(this.pageNum),this.isLoading=!1}).catch(l=>{u.fire({icon:"error",title:l.response.data.message,showConfirmButton:!1,timer:1500}),this.isLoading=!1})},openModal(l,t){this.operateType=l,l==="create"?(this.tempProduct={imagesUrl:[]},this.$refs.productModal.showModal()):l==="modify"?(this.tempProduct={...t},this.$refs.productModal.showModal()):l==="delete"&&(this.tempProduct={...t},this.$refs.delModal.showModal())}},components:{PaginationComponent:V,ProductModal:ke,DelModal:C},mounted(){this.getProducts()}},Ce={class:"container"},xe={class:"text-end mt-4"},Te={class:"table table-hover mt-4"},Le=e("thead",null,[e("tr",null,[e("th",{width:"120"}," 分類 "),e("th",null,"產品名稱"),e("th",{width:"120"}," 原價 "),e("th",{width:"120"}," 售價 "),e("th",{width:"100"}," 是否啟用 "),e("th",{width:"120"}," 編輯 ")])],-1),Ae={class:"text-end"},Ee={class:"text-end"},De={key:0,class:"text-success"},Be={key:1},Fe={class:"btn-group"},$e=["onClick"],Se=["onClick"];function He(l,t,r,M,m,o){const s=p("VueLoading"),h=p("PaginationComponent"),P=p("ProductModal"),I=p("DelModal");return i(),a(v,null,[_(s,{active:m.isLoading},null,8,["active"]),e("div",Ce,[e("div",xe,[e("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=d=>o.openModal("create"))}," 建立新的產品 ")]),e("table",Te,[Le,e("tbody",null,[(i(!0),a(v,null,U(m.products,d=>(i(),a("tr",{key:d.id},[e("td",null,f(d.category),1),e("td",null,f(d.title),1),e("td",Ae,f(d.origin_price),1),e("td",Ee,f(d.price),1),e("td",null,[d.is_enabled?(i(),a("span",De,"啟用")):(i(),a("span",Be,"未啟用"))]),e("td",null,[e("div",Fe,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:w=>o.openModal("modify",d)}," 編輯 ",8,$e),e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:w=>o.openModal("delete",d)}," 刪除 ",8,Se)])])]))),128))])]),_(h,{pagination:m.pagination,onChangePage:o.getProducts},null,8,["pagination","onChangePage"])]),_(P,{ref:"productModal","temp-product":m.tempProduct,"operate-type":m.operateType,onSaveProduct:o.saveProduct},null,8,["temp-product","operate-type","onSaveProduct"]),_(I,{ref:"delModal","temp-item":m.tempProduct,onDeleteItem:o.deleteProduct},null,8,["temp-item","onDeleteItem"])],64)}const je=y(Ve,[["render",He]]);export{je as default};
